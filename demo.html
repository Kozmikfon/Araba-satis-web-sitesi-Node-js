<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Araç Detayları</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <style>
      /* Genel stil */
      body {
        font-family: Roboto, Arial, sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 0;
        background-color: #f5f5f5;
        color: #333;
      }

      .container {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .car-detail {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .car-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: #222;
        text-align: center;
        margin-bottom: 20px;
      }

      .car-price {
        font-size: 2rem;
        color: #4caf50;
        font-weight: bold;
        text-align: center;
        margin-bottom: 20px;
      }

      /* Galeri */
      .car-images {
        position: relative;
        overflow: hidden;
        width: 100%;
        max-height: 400px;
        margin-bottom: 20px;
      }

      .car-images img {
        width: 100%;
        border-radius: 8px;
      }

      .gallery-buttons {
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        display: flex;
        justify-content: space-between;
        padding: 0 20px;
        transform: translateY(-50%);
      }

      .gallery-buttons button {
        background: rgba(0, 0, 0, 0.5);
        color: white;
        border: none;
        border-radius: 50%;
        font-size: 1.5rem;
        cursor: pointer;
        padding: 10px;
        transition: background 0.3s ease;
      }

      .gallery-buttons button:hover {
        background: rgba(0, 0, 0, 0.8);
      }

      .car-details {
        margin-top: 30px;
      }

      .car-details h3 {
        font-size: 1.8rem;
        color: #444;
        margin-bottom: 15px;
      }

      .car-details p {
        font-size: 1.1rem;
        color: #666;
        margin-bottom: 10px;
      }

      .btn-back,
      .btn-contact {
        padding: 12px 20px;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        text-align: center;
        font-size: 1rem;
        transition: background 0.3s ease;
        text-decoration: none;
        display: inline-block;
        margin: 10px 5px;
      }

      .btn-contact {
        background-color: #e84242;
      }

      .btn-back:hover {
        background-color: #45a049;
      }

      .btn-contact:hover {
        background-color: #e64a19;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .car-title {
          font-size: 1.8rem;
        }

        .car-price {
          font-size: 1.5rem;
        }

        .car-details h3 {
          font-size: 1.5rem;
        }

        .car-details p {
          font-size: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <div>
      <button id="toggle-messages-button">Mesajları Görüntüle</button>
      <div id="messages-container" style="display: none"></div>
    </div>

    <div class="container">
      <div class="car-detail">
        <h1 class="car-title" id="car-title">Araç Başlığı</h1>
        <div class="car-price" id="car-price">Fiyat:</div>

        <div class="car-images">
          <img src="" alt="Araç Görsel 1" id="current-image" />
          <div class="gallery-buttons">
            <button onclick="prevImage()">❮</button>
            <button onclick="nextImage()">❯</button>
          </div>
        </div>

        <div class="car-details">
          <h3>Genel Bilgiler</h3>
          <p><strong>Marka:</strong> <span id="car-brand">Marka</span></p>
          <p><strong>Seri:</strong> <span id="car-series">Seri</span></p>
          <p><strong>Model:</strong> <span id="car-model">Model</span></p>
          <p><strong>Yıl:</strong> <span id="car-year">Yıl</span></p>
          <p>
            <strong>Kilometre:</strong> <span id="car-mileage">Kilometre</span>
          </p>
        </div>

        <button class="btn-contact" onclick="openPopup()">
          <i class="fas fa-envelope"></i> İletişime Geç
        </button>
        <a href="javascript:history.back()" class="btn-back">
          <i class="fas fa-arrow-left"></i> Geri Dön
        </a>
      </div>
    </div>

    <!-- Popup Form -->
    <div id="popup-form" style="display: none">
      <div class="popup-content">
        <h3>Mesajlaşma</h3>
        <textarea
          id="message-input"
          placeholder="Mesajınızı buraya yazın..."
        ></textarea>
        <button onclick="sendMessage()">Mesaj Gönder</button>
        <button onclick="closePopup()">Kapat</button>
      </div>
    </div>

    <script>
      const images = ["image1.jpg", "image2.jpg", "image3.jpg"];
      let currentIndex = 0;

      function updateImage() {
        const imageElement = document.getElementById("current-image");
        imageElement.src = images[currentIndex];
      }

      function prevImage() {
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        updateImage();
      }

      function nextImage() {
        currentIndex = (currentIndex + 1) % images.length;
        updateImage();
      }

      function openPopup() {
        const token = localStorage.getItem("userToken");
        if (!token) {
          alert("Mesaj göndermek için giriş yapmanız gerekiyor.");
          window.location.href = "login.html";
          return;
        }
        document.getElementById("popup-form").style.display = "flex";
      }

      function closePopup() {
        document.getElementById("popup-form").style.display = "none";
      }

      async function sendMessage() {
        const content = document.getElementById("message-input").value.trim();
        if (!content) {
          alert("Lütfen mesajınızı yazın.");
          return;
        }

        const token = localStorage.getItem("userToken");
        if (!token) {
          alert("Mesaj göndermek için giriş yapmanız gerekiyor.");
          window.location.href = "login.html";
          return;
        }

        try {
          const response = await fetch(
            "http://localhost:5024/api/messages/send",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${token}`,
              },
              body: JSON.stringify({ content }),
            }
          );

          if (!response.ok) {
            throw new Error("Mesaj gönderilemedi.");
          }

          alert("Mesaj gönderildi!");
          document.getElementById("message-input").value = "";
        } catch (error) {
          alert("Bir hata oluştu: " + error.message);
        }
      }
    </script>
    <div
    id="user-info"
    style="
      position: absolute;
      top: 10px;
      right: 10px;
      background: #f3f3f3;
      padding: 10px;
      border-radius: 5px;
      display: none;
    "
  >
    <span id="username-display"></span>
    <a href="#" id="logout-button" style="display: none">Çıkış Yap</a>
  </div>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const token = localStorage.getItem("userToken");
      const userArea = document.createElement("div");
      userArea.style.position = "absolute";
      userArea.style.top = "10px";
      userArea.style.right = "10px";
      userArea.style.padding = "10px";
      userArea.style.backgroundColor = "#f0f0f0";
      userArea.style.borderRadius = "5px";

      if (token) {
        const user = JSON.parse(atob(token.split(".")[1])); // Token'dan kullanıcı verisi alınır
        userArea.textContent = `Hoş geldiniz, ${user.username}!`;
        const logoutButton = document.createElement("button");
        logoutButton.textContent = "Çıkış Yap";
        logoutButton.style.marginLeft = "10px";
        logoutButton.onclick = () => {
          localStorage.removeItem("userToken");
          alert("Başarıyla çıkış yapıldı.");
          window.location.reload();
        };
        userArea.appendChild(logoutButton);
      } else {
        userArea.innerHTML = `<a href="login.html">Giriş Yap</a> | <a href="register.html">Üye Ol</a>`;
      }

      document.body.appendChild(userArea);
    });
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const token = localStorage.getItem("userToken");
      const logoutButton = document.getElementById("logout-button");
      const registerButton = document.getElementById("register-button");

      if (token) {
        const user = JSON.parse(atob(token.split(".")[1]));
        document.getElementById(
          "user-info"
        ).textContent = `Hoş geldiniz, ${user.username}!`;
        registerButton.style.display = "none"; // Üye ol butonunu gizle
        logoutButton.style.display = "inline"; // Çıkış yap butonunu göster

        // Çıkış yap işlemi
        logoutButton.addEventListener("click", () => {
          localStorage.removeItem("userToken"); // Token'ı sil
          alert("Başarıyla çıkış yaptınız.");
          window.location.reload(); // Sayfayı yenile
        });
      }
    });
  </script>
  <style>
    #user-info {
      position: absolute;
      top: 10px;
      right: 10px;
      background: linear-gradient(135deg, #4e54c8, #8f94fb);
      color: white;
      padding: 20px 25px;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      font-family: "Segoe UI", Tahoma, Geneva, sans-serif;
      font-size: 16px;
      display: none;
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    #username-display {
      display: inline-block;
      font-size: 20px; /* Daha büyük yazı */
      font-weight: bold;
      background: linear-gradient(90deg, #ff7f50, #ffcc00, #4e54c8);
      background-clip: text; /* Renk geçişini yazıya uygula */
      -webkit-background-clip: text; /* WebKit için */
      color: transparent; /* Arka planı metne uygula */
      animation: shine 3s infinite; /* Sürekli parlayan animasyon */
    }

    @keyframes shine {
      0% {
        background-position: -200%;
      }
      50% {
        background-position: 200%;
      }
      100% {
        background-position: -200%;
      }
    }

    #user-info button,
    #user-info a {
      color: white;
      text-decoration: none;
      font-weight: bold;
      margin: 5px 10px 0 0;
      padding: 8px 16px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
      display: inline-block;
    }

    #user-info button:hover,
    #user-info a:hover {
      background: rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 8px rgba(255, 255, 255, 0.4);
      color: #4e54c8;
    }

    #user-info::before {
      content: "🎉 "; /* Emoji ile hoş bir dokunuş */
      font-size: 24px;
      margin-right: 10px;
      vertical-align: middle;
    }

    
  </style>


  </body>
</html>
